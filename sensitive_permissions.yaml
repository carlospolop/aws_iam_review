
apigateway:
  urls:
    - https://cloud.hacktricks.wiki/pentesting-cloud/aws-security/aws-privilege-escalation/aws-apigateway-privesc/index.html
    - https://cloud.hacktricks.wiki/pentesting-cloud/aws-security/aws-post-exploitation/aws-api-gateway-post-exploitation/index.html
    - https://cloud.hacktricks.wiki/pentesting-cloud/aws-security/aws-persistence/aws-api-gateway-persistence/index.html
  
  sensitive:
    - apigateway:POST
    - apigateway:GET
    - apigateway:UpdateGatewayResponse, apigateway:CreateDeployment
    - apigateway:UpdateStage, apigateway:CreateDeployment
    - apigateway:PutMethodResponse, apigateway:CreateDeployment
    - apigateway:UpdateRestApi, apigateway:CreateDeployment
    - apigateway:CreateApiKey, apigateway:UpdateApiKey, apigateway:CreateUsagePlan, apigateway:CreateUsagePlanKey
    - apigateway:UpdateRestApiPolicy, apigateway:PATCH
    - apigateway:PutIntegration
    - apigateway:UpdateAuthorizer
    - apigateway:UpdateVpcLink


chime:
  urls:
    - https://cloud.hacktricks.wiki/pentesting-cloud/aws-security/aws-privilege-escalation/aws-chime-privesc/index.html
  
  sensitive:
    - chime:CreateApiKey

codebuild:
  urls:
    - https://cloud.hacktricks.wiki/pentesting-cloud/aws-security/aws-privilege-escalation/aws-codebuild-privesc/index.html
    - https://cloud.hacktricks.wiki/pentesting-cloud/aws-security/aws-post-exploitation/aws-codebuild-post-exploitation/index.html

  privesc:
    - iam:PassRole, codebuild:CreateProject
    - iam:PassRole, codebuild:UpdateProject
    - codebuild:UpdateProject
    - codebuild:CreateProject, codebuild:StartBuild
  
  sensitive:
    - codebuild:DeleteProject
    - codebuild:DeleteSourceCredentials
    - codebuild:StartBuildBatch
    - codebuild:ListProjects
    - codebuild:ListRepositories

codepipeline:
  urls:
    - https://cloud.hacktricks.wiki/pentesting-cloud/aws-security/aws-privilege-escalation/aws-codepipeline-privesc/index.html

  pivesc:
    - iam:PassRole, codepipeline:CreatePipeline, codebuild:CreateProject, codepipeline:StartPipelineExecution
    - codebuild:UpdateProject, codepipeline:UpdatePipeline, codepipeline:StartPipelineExecution

  sensitive:
    - codepipeline:pollforjobs


codestar:
  urls:
    - https://cloud.hacktricks.wiki/pentesting-cloud/aws-security/aws-privilege-escalation/aws-codestar-privesc/index.html

  privesc:
    - iam:PassRole, codestar:CreateProject
    - codestar:CreateProject, codestar:AssociateTeamMember
    - codestar:CreateProjectFromTemplate

cloudformation:
  urls:
    - https://cloud.hacktricks.wiki/pentesting-cloud/aws-security/aws-privilege-escalation/aws-cloudformation-privesc/index.html
    - https://cloud.hacktricks.wiki/pentesting-cloud/aws-security/aws-persistence/aws-cloudformation-persistence/index.html
  
  privesc:
    - iam:PassRole, cloudformation:CreateStack
    - iam:PassRole, cloudformation:UpdateStack
    - iam:PassRole, cloudformation:SetStackPolicy
    - cloudformation:UpdateStack
    - cloudformation:SetStackPolicy
    - iam:PassRole, cloudformation:CreateChangeSet, cloudformation:ExecuteChangeSet, cloudformation:SetStackPolicy
    - iam:PassRole, cloudformation:SetStackPolicy
    - cloudformation:CreateChangeSet, cloudformation:ExecuteChangeSet
    - cloudformation:SetStackPolicy
    - iam:PassRole, cloudformation:CreateStackSet
    - iam:PassRole, cloudformation:UpdateStackSet
    - cloudformation:UpdateStackSet
  
  sensitive:
    - cloudformation:DescribeStacks
    - cloudformation:DescribeStackResources
    - cloudformation:GetTemplate

cognito:
  urls:
    - https://cloud.hacktricks.wiki/pentesting-cloud/aws-security/aws-privilege-escalation/aws-cognito-privesc/index.html
    - https://cloud.hacktricks.wiki/pentesting-cloud/aws-security/aws-persistence/aws-cognito-persistence/index.html
  
  # Note: This service is now split into cognito-identity and cognito-idp

datapipeline:
  urls:
    - https://cloud.hacktricks.wiki/pentesting-cloud/aws-security/aws-privilege-escalation/aws-datapipeline-privesc/index.html
  
  privesc:
    - iam:PassRole, datapipeline:CreatePipeline, datapipeline:PutPipelineDefinition, datapipeline:ActivatePipeline

ds:
  urls:
    - https://cloud.hacktricks.wiki/pentesting-cloud/aws-security/aws-privilege-escalation/aws-directory-services-privesc/index.html
  
  sensitive:
    - ds:ResetUserPassword

dynamodb:
  urls:
    - https://cloud.hacktricks.wiki/pentesting-cloud/aws-security/aws-post-exploitation/aws-dynamodb-post-exploitation/index.html
    - https://cloud.hacktricks.wiki/pentesting-cloud/aws-security/aws-privilege-escalation/aws-dynamodb-privesc/index.html
    - https://cloud.hacktricks.wiki/pentesting-cloud/aws-security/aws-persistence/aws-dynamodb-persistence/index.html
  
  privesc:
    - dynamodb:PutResourcePolicy
    - dynamodb:GetResourcePolicy
  
  sensitive:
    - dynamodb:BatchGetItem
    - dynamodb:GetItem
    - dynamodb:Query
    - dynamodb:Scan
    - dynamodb:PartiQLSelect
    - dynamodb:ExportTableToPointInTime
    - dynamodb:CreateTable, dynamodb:RestoreTableFromBackup
    - dynamodb:PutItem
    - dynamodb:UpdateItem
    - dynamodb:DeleteTable
    - dynamodb:DeleteBackup
    - dynamodb:UpdateTable
    - dynamodb:DescribeTable
    - dynamodb:UpdateContinuousBackups
    - dynamodb:EnableKinesisStreamingDestination


ebs:
  urls:
    - https://cloud.hacktricks.wiki/pentesting-cloud/aws-security/aws-privilege-escalation/aws-ebs-privesc/index.html
  
  sensitive:
    - ebs:ListSnapshotBlocks, ebs:GetSnapshotBlock, ec2:DescribeSnapshots
    - ec2:CreateSnapshot

ec2:
  urls:
    - https://cloud.hacktricks.wiki/pentesting-cloud/aws-security/aws-privilege-escalation/aws-ec2-privesc/index.html
    - https://cloud.hacktricks.wiki/pentesting-cloud/aws-security/aws-post-exploitation/aws-ec2-ebs-ssm-and-vpc-post-exploitation/index.html
    - https://cloud.hacktricks.wiki/pentesting-cloud/aws-security/aws-persistence/aws-ec2-persistence/index.html
  
  privesc:
    - iam:PassRole, ec2:RunInstances
    - iam:PassRole, iam:AddRoleToInstanceProfile
    - ec2:RequestSpotInstances, iam:PassRole
    - ec2:ModifyInstanceAttribute
    - ec2:CreateLaunchTemplateVersion, ec2:CreateLaunchTemplate, ec2:ModifyLaunchTemplate
    - autoscaling:CreateLaunchConfiguration, autoscaling:CreateAutoScalingGroup, iam:PassRole
    - ec2:AssociateIamInstanceProfile
  
  sensitive:
    - ec2:DescribeVolumes, dlm:CreateLifeCyclePolicy
    - ec2:DescribeInstances, ec2:RunInstances, ec2:CreateSecurityGroup, ec2:AuthorizeSecurityGroupIngress, ec2:CreateTrafficMirrorTarget, ec2:CreateTrafficMirrorSession, ec2:CreateTrafficMirrorFilter, ec2:CreateTrafficMirrorFilterRule
    - ec2:CreateSnapshot
    - ec2:CreateImage
    - ec2:AttachVolume
    - ec2:AssignPrivateIpAddresses
    - ec2:AssociateAddress
    - ec2:CreateFlowLogs
    - ec2:CreateInstanceConnectEndpoint
    - ec2:CreateKeyPair
    - ec2:CreateManagedPrefixList
    - ec2:CreateReplaceRootVolumeTask
    - ec2:DeleteSnapshot
    - ec2:DescribeAddresses
    - ec2:DescribeFlowLogs
    - ec2:DescribeInternetGateways
    - ec2:DescribeInstanceTypeOfferings

ecr:
  urls:
    - https://cloud.hacktricks.wiki/pentesting-cloud/aws-security/aws-privilege-escalation/aws-ecr-privesc/index.html
    - https://cloud.hacktricks.wiki/pentesting-cloud/aws-security/aws-post-exploitation/aws-ecr-post-exploitation/index.html
    - https://cloud.hacktricks.wiki/pentesting-cloud/aws-security/aws-persistence/aws-ecr-persistence/index.html
  
  sensitive:
    - ecr:GetAuthorizationToken, ecr:BatchGetImage
    - ecr:GetAuthorizationToken, ecr:BatchCheckLayerAvailability, ecr:CompleteLayerUpload, ecr:InitiateLayerUpload, ecr:PutImage, ecr:UploadLayerPart
    - ecr:SetRepositoryPolicy
    - ecr:PutRegistryPolicy
    - ecr:PutLifecyclePolicy
    - ecr:DeleteRepository
    - ecr:BatchDeleteImage
    - ecr:CreateRepository
    - ecr:PutImageScanningConfiguration
    - ecr:PutImageTagMutability
    - ecr:ReplicateImage
    - ecr:GetRegistryPolicy
    - ecr:DescribeImages

ecs:
  urls:
    - https://cloud.hacktricks.wiki/pentesting-cloud/aws-security/aws-privilege-escalation/aws-ecs-privesc/index.html
    - https://cloud.hacktricks.wiki/pentesting-cloud/aws-security/aws-post-exploitation/aws-ecs-post-exploitation/index.html
    - https://cloud.hacktricks.wiki/pentesting-cloud/aws-security/aws-persistence/aws-ecs-persistence/index.html
  
  privesc:
    - iam:PassRole, ecs:RegisterTaskDefinition, ecs:RunTask
    - iam:PassRole, ecs:RegisterTaskDefinition, ecs:StartTask
    - iam:PassRole, ecs:RegisterTaskDefinition, ecs:CreateService
    - iam:PassRole, ecs:RegisterTaskDefinition, ecs:CreateService
    - ecs:RegisterTaskDefinition, ecs:RunTask
    - ecs:RegisterTaskDefinition, ecs:StartTask
    - ecs:RegisterTaskDefinition, ecs:UpdateService
    - ecs:RegisterTaskDefinition, ecs:CreateService
    - ecs:ExecuteCommand, ecs:DescribeTasks, ecs:RunTask
    - ecs:ExecuteCommand, ecs:DescribeTasks, ecs:StartTask
    - ecs:ExecuteCommand, ecs:DescribeTasks, ecs:UpdateService
    - ecs:ExecuteCommand, ecs:DescribeTasks, ecs:CreateService
  
  sensitive:
    - ecs:CreateCluster
    - ecs:DeregisterContainerInstance
    - ecs:RegisterContainerInstance

efs:
  urls:
    - https://cloud.hacktricks.wiki/pentesting-cloud/aws-security/aws-privilege-escalation/aws-efs-privesc/index.html
    - https://cloud.hacktricks.wiki/pentesting-cloud/aws-security/aws-post-exploitation/aws-efs-post-exploitation/index.html
    - https://cloud.hacktricks.wiki/pentesting-cloud/aws-security/aws-persistence/aws-efs-persistence/index.html
  
  # Note: This service uses elasticfilesystem prefix

elasticbeanstalk:
  urls:
    - https://cloud.hacktricks.wiki/pentesting-cloud/aws-security/aws-privilege-escalation/aws-elastic-beanstalk-privesc/index.html
    - https://cloud.hacktricks.wiki/pentesting-cloud/aws-security/aws-post-exploitation/aws-elastic-beanstalk-post-exploitation/index.html
    - https://cloud.hacktricks.wiki/pentesting-cloud/aws-security/aws-persistence/aws-elastic-beanstalk-persistence/index.html
  
  privesc:
    - elasticbeanstalk:CreateApplication, elasticbeanstalk:CreateEnvironment, elasticbeanstalk:CreateApplicationVersion, elasticbeanstalk:UpdateEnvironment, iam:PassRole
    - elasticbeanstalk:CreateApplicationVersion, elasticbeanstalk:UpdateEnvironment, cloudformation:GetTemplate, cloudformation:DescribeStackResources, cloudformation:DescribeStackResource, autoscaling:DescribeAutoScalingGroups, autoscaling:SuspendProcesses

  sensitive:
    - elasticbeanstalk:DeleteApplicationVersion
    - elasticbeanstalk:TerminateEnvironment
    - elasticbeanstalk:DeleteApplication
    - elasticbeanstalk:RebuildEnvironment
    - elasticbeanstalk:SwapEnvironmentCNAMEs


emr:
  urls:
    - https://cloud.hacktricks.wiki/pentesting-cloud/aws-security/aws-privilege-escalation/aws-emr-privesc/index.html
  
  # Note: This service uses elasticmapreduce prefix
    
gamelift:
  urls:
    - https://cloud.hacktricks.wiki/pentesting-cloud/aws-security/aws-privilege-escalation/aws-gamelift/index.html
  
  sensitive:
    - gamelift:RequestUploadCredentials

glue:
  urls:
    - https://cloud.hacktricks.wiki/pentesting-cloud/aws-security/aws-privilege-escalation/aws-glue-privesc/index.html
  
  privesc:
    - iam:PassRole, glue:CreateDevEndpoint
    - glue:UpdateDevEndpoint
    - iam:PassRole, glue:CreateJob, glue:StartJobRun
    - iam:PassRole, glue:CreateJob, glue:CreateTrigger
    - iam:PassRole, glue:UpdateJob, glue:StartJobRun
    - iam:PassRole, glue:UpdateJob, glue:CreateTrigger
    - glue:UpdateJob

iam:
  urls:
    - https://cloud.hacktricks.wiki/pentesting-cloud/aws-security/aws-privilege-escalation/aws-iam-privesc/index.html
    - https://cloud.hacktricks.wiki/pentesting-cloud/aws-security/aws-post-exploitation/aws-iam-post-exploitation/index.html
    - https://cloud.hacktricks.wiki/pentesting-cloud/aws-security/aws-persistence/aws-iam-persistence/index.html
  
  privesc:
    - iam:CreatePolicyVersion
    - iam:SetDefaultPolicyVersion
    - iam:CreateAccessKey
    - iam:CreateLoginProfile
    - iam:UpdateLoginProfile
    - iam:CreateServiceSpecificCredential
    - iam:ResetServiceSpecificCredential
    - iam:AttachUserPolicy
    - iam:AttachGroupPolicy
    - iam:AttachRolePolicy
    - iam:PutUserPolicy
    - iam:PutGroupPolicy
    - iam:PutRolePolicy
    - iam:AddUserToGroup
    - iam:UpdateAssumeRolePolicy
    - iam:UploadSSHPublicKey
    - iam:DeactivateMFADevice
    - iam:ResyncMFADevice
    - iam:UpdateSAMLProvider, iam:ListSAMLProviders
    - iam:UpdateOpenIDConnectProviderThumbprint, iam:ListOpenIDConnectProviders
    - iam:CreateRole
    - iam:CreateInstanceProfile
    - iam:AddRoleToInstanceProfile
  
  sensitive:
    - iam:DeleteAccessKey
    - iam:DeleteUser
    - iam:DeleteRole
    - iam:DeletePolicy
    - iam:DeleteGroup
    - iam:DeleteLoginProfile
    - iam:DeleteRolePolicy
    - iam:DeleteUserPolicy
    - iam:DeleteGroupPolicy
    - iam:DeleteSSHPublicKey
    - iam:DeleteServiceSpecificCredential
    - iam:DeleteInstanceProfile

kms:
  urls:
    - https://cloud.hacktricks.wiki/pentesting-cloud/aws-security/aws-privilege-escalation/aws-kms-privesc/index.html
    - https://cloud.hacktricks.wiki/pentesting-cloud/aws-security/aws-post-exploitation/aws-kms-post-exploitation/index.html
    - https://cloud.hacktricks.wiki/pentesting-cloud/aws-security/aws-persistence/aws-kms-persistence/index.html
  
  privesc:
    - kms:PutKeyPolicy
    - kms:CreateGrant
  
  sensitive:
    - kms:CreateKey, kms:ReplicateKey
    - kms:Decrypt
    - kms:Encrypt
    - kms:DescribeKey
    - kms:DisableKey
    - kms:EnableKey
    - kms:DeleteAlias
    - kms:CreateAlias
    - kms:GenerateDataKey

lambda:
  urls:
    - https://cloud.hacktricks.wiki/pentesting-cloud/aws-security/aws-privilege-escalation/aws-lambda-privesc/index.html
    - https://cloud.hacktricks.wiki/pentesting-cloud/aws-security/aws-post-exploitation/aws-lambda-post-exploitation/index.html
    - https://cloud.hacktricks.wiki/pentesting-cloud/aws-security/aws-persistence/aws-lambda-persistence/index.html
  
  privesc:
    - iam:PassRole, lambda:CreateFunction, lambda:InvokeFunction
    - iam:PassRole, lambda:CreateFunction, lambda:InvokeFunctionUrl
    - iam:PassRole, lambda:CreateFunction, lambda:AddPermission
    - iam:PassRole, lambda:CreateFunction, lambda:CreateEventSourceMapping
    - lambda:AddPermission
    - lambda:UpdateFunctionCode
    - lambda:UpdateFunctionConfiguration
  
  sensitive:
    - lambda:AddLayerVersionPermission
    - lambda:PublishLayerVersion
    - lambda:CreateFunctionUrlConfig
    - lambda:UpdateFunctionUrlConfig
    - lambda:GetFunctionConfiguration
    - lambda:ListFunctions
    - lambda:ListLayers
    - lambda:PublishVersion
    - lambda:UpdateEventSourceMapping
    - lambda:GetLayerVersion

lightsail:
  urls:
    - https://cloud.hacktricks.wiki/pentesting-cloud/aws-security/aws-privilege-escalation/aws-lightsail-privesc/index.html
    - https://cloud.hacktricks.wiki/pentesting-cloud/aws-security/aws-post-exploitation/aws-lightsail-post-exploitation/index.html
    - https://cloud.hacktricks.wiki/pentesting-cloud/aws-security/aws-persistence/aws-lightsail-persistence/index.html
  
  sensitive:
    - lightsail:DownloadDefaultKeyPair
    - lightsail:GetInstanceAccessDetails
    - lightsail:GetRelationalDatabaseMasterUserPassword
    - lightsail:UpdateRelationalDatabase
    - lightsail:OpenInstancePublicPorts
    - lightsail:PutInstancePublicPorts
    - lightsail:SetResourceAccessForBucket
    - lightsail:CreateBucketAccessKey
    - lightsail:UpdateBucket
    - lightsail:UpdateContainerService
    - lightsail:CreateDomainEntry
    - lightsail:UpdateDomainEntry

mediapackage:
  urls:
    - https://cloud.hacktricks.wiki/pentesting-cloud/aws-security/aws-privilege-escalation/aws-mediapackage-privesc/index.html
  
  sensitive:
    - mediapackage:RotateChannelCredentials
    - mediapackage:RotateIngestEndpointCredentials

mq:
  urls:
    - https://cloud.hacktricks.wiki/pentesting-cloud/aws-security/aws-privilege-escalation/aws-mq-privesc/index.html
  
  sensitive:
    - mq:ListBrokers, mq:CreateUser
    - mq:ListBrokers, mq:ListUsers, mq:UpdateUser
    - mq:ListBrokers, mq:UpdateBroker

msk:
  urls:
    - https://cloud.hacktricks.wiki/pentesting-cloud/aws-security/aws-privilege-escalation/aws-msk-privesc/index.html
  
  sensitive:
    - msk:ListClusters, msk:UpdateSecurity

rds:
  urls:
    - https://cloud.hacktricks.wiki/pentesting-cloud/aws-security/aws-post-exploitation/aws-rds-post-exploitation/index.html
    - https://cloud.hacktricks.wiki/pentesting-cloud/aws-security/aws-privilege-escalation/aws-rds-privesc/index.html
    - https://cloud.hacktricks.wiki/pentesting-cloud/aws-security/aws-persistence/aws-rds-persistence/index.html
  
  sensitive:
    - rds:ModifyDBInstance
    - rds:CreateDBSnapshot, rds:RestoreDBInstanceFromDBSnapshot, rds:ModifyDBInstance
    - rds-db:connect
    - rds:DownloadDBLogFilePortion
    - rds:DeleteDBInstance
    - rds:StartExportTask
    - rds:CreateDBInstance
    - rds:ModifyDBCluster
    - rds:AddRoleToDBInstance
    - rds:AddRoleToDBCluster
    - rds:DescribeDBInstances
    - rds:DescribeDBClusters
    - rds:EnableHttpEndpoint
    - rds:CreateDBInstanceReadReplica

redshift:
  urls:
    - https://cloud.hacktricks.wiki/pentesting-cloud/aws-security/aws-privilege-escalation/aws-redshift-privesc/index.html
  
  sensitive:
    - redshift:DescribeClusters, redshift:GetClusterCredentials
    - redshift:DescribeClusters, redshift:GetClusterCredentialsWithIAM
    - redshift:DescribeClusters, redshift:ModifyCluster

route53:
  urls:
    - https://cloud.hacktricks.wiki/pentesting-cloud/aws-security/aws-privilege-escalation/route53-createhostedzone-route53-changeresourcerecordsets-acm-pca-issuecertificate-acm-pca-getcer/index.html
  sensitive:
    - route53:CreateHostedZone, route53:ChangeResourceRecordSets, acm-pca:IssueCertificate, acm-pca:GetCertificate

sns:
  urls:
    - https://cloud.hacktricks.wiki/pentesting-cloud/aws-security/aws-post-exploitation/aws-sns-post-exploitation/index.html
    - https://cloud.hacktricks.wiki/pentesting-cloud/aws-security/aws-privilege-escalation/aws-sns-privesc/index.html
    - https://cloud.hacktricks.wiki/pentesting-cloud/aws-security/aws-persistence/aws-sns-persistence/index.html
  
  sensitive:
    - sns:DeleteTopic
    - sns:Publish
    - sns:SetTopicAttributes
    - sns:Subscribe
    - sns:Unsubscribe
    - sns:AddPermission
    - sns:RemovePermission
    - sns:CreateTopic
    - sns:PutDataProtectionPolicy

sqs:
  urls: 
    - https://cloud.hacktricks.wiki/pentesting-cloud/aws-security/aws-post-exploitation/aws-sqs-post-exploitation/index.html
    - https://cloud.hacktricks.wiki/pentesting-cloud/aws-security/aws-privilege-escalation/aws-sqs-privesc/index.html
    - https://cloud.hacktricks.wiki/pentesting-cloud/aws-security/aws-persistence/aws-sqs-persistence/index.html
  
  sensitive:
    - sqs:AddPermission
    - sqs:SendMessage
    - sqs:SendMessageBatch
    - sqs:ReceiveMessage
    - sqs:DeleteMessage
    - sqs:ChangeMessageVisibility
    - sqs:DeleteQueue
    - sqs:PurgeQueue
    - sqs:RemovePermission
    - sqs:CreateQueue
    - sqs:SetQueueAttributes


sso:
  urls:
    - https://cloud.hacktricks.wiki/pentesting-cloud/aws-security/aws-privilege-escalation/aws-sso-and-identitystore-privesc/index.html
  
  privesc:
    - identitystore:CreateGroupMembership
    - sso:PutInlinePolicyToPermissionSet, sso:ProvisionPermissionSet
    - sso:AttachManagedPolicyToPermissionSet, sso:ProvisionPermissionSet
    - sso:AttachCustomerManagedPolicyToPermissionSet, sso:ProvisionPermissionSet
    - sso:CreateAccountAssignment

s3:
  urls:
    - https://cloud.hacktricks.wiki/pentesting-cloud/aws-security/aws-privilege-escalation/aws-s3-privesc/index.html
    - https://cloud.hacktricks.wiki/pentesting-cloud/aws-security/aws-post-exploitation/aws-s3-post-exploitation/index.html
    - https://cloud.hacktricks.wiki/pentesting-cloud/aws-security/aws-persistence/aws-s3-persistence/index.html
  
  sensitive:
    - s3:PutObject
    - s3:GetObject
    - s3:PutBucketPolicy
    - s3:PutBucketAcl
    - s3:PutObjectVersionAcl
    - s3:PutBucketVersioning
    - s3:DeleteObject
    - s3:DeleteBucket

sagemaker:
  urls:
    - https://cloud.hacktricks.wiki/pentesting-cloud/aws-security/aws-privilege-escalation/aws-sagemaker-privesc/index.html
    - https://cloud.hacktricks.wiki/pentesting-cloud/aws-security/aws-post-exploitation/aws-sagemaker-post-exploitation/index.html
    - https://cloud.hacktricks.wiki/pentesting-cloud/aws-security/aws-persistence/aws-sagemaker-persistence/index.html
  
  privesc:
    - iam:PassRole, sagemaker:CreateNotebookInstance, sagemaker:CreatePresignedNotebookInstanceUrl
    - sagemaker:CreatePresignedNotebookInstanceUrl
    - sagemaker:CreateProcessingJob, iam:PassRole
    - sagemaker:CreateTrainingJob, iam:PassRole
    - sagemaker:CreateHyperParameterTuningJob, iam:PassRole

secretsmanager:
  urls:
    - https://cloud.hacktricks.wiki/pentesting-cloud/aws-security/aws-privilege-escalation/aws-secrets-manager-privesc/index.html
    - https://cloud.hacktricks.wiki/pentesting-cloud/aws-security/aws-post-exploitation/aws-secrets-manager-post-exploitation/index.html
    - https://cloud.hacktricks.wiki/pentesting-cloud/aws-security/aws-persistence/aws-secrets-manager-persistence/index.html
  
  sensitive:
    - secretsmanager:GetSecretValue
    - secretsmanager:PutResourcePolicy
    - secretsmanager:PutSecretValue
    - secretsmanager:CreateSecret
    - secretsmanager:DeleteSecret
    - secretsmanager:UpdateSecret

ssm:
  urls:
    - https://cloud.hacktricks.wiki/pentesting-cloud/aws-security/aws-privilege-escalation/aws-ssm-privesc/index.html
    - https://cloud.hacktricks.wiki/pentesting-cloud/aws-security/aws-post-exploitation/aws-ec2-ebs-ssm-and-vpc-post-exploitation/index.html
    - https://cloud.hacktricks.wiki/pentesting-cloud/aws-security/aws-persistence/aws-ssm-persistence/index.html
  
  privesc:
    - ssm:SendCommand
    - ssm:StartSession
    - ssm:ResumeSession
  
  sensitive:
    - ssm:DescribeParameters
    - ssm:ListCommands
    - ssm:GetCommandInvocation
    - ssm:GetParameter
    - ssm:GetParameters
    - ssm:PutParameter
    - ssm:DeleteParameter

sts:
  urls:
    - https://cloud.hacktricks.wiki/pentesting-cloud/aws-security/aws-privilege-escalation/aws-sts-privesc/index.html
    - https://cloud.hacktricks.wiki/pentesting-cloud/aws-security/aws-post-exploitation/aws-sts-post-exploitation/index.html
    - https://cloud.hacktricks.wiki/pentesting-cloud/aws-security/aws-persistence/aws-sts-persistence/index.html
  
  privesc:
    - sts:AssumeRole
    - sts:AssumeRoleWithSAML
    - sts:AssumeRoleWithWebIdentity
  
  sensitive:
    - sts:GetFederationToken
    - sts:GetSessionToken

workdocs:
  urls:
    - https://cloud.hacktricks.wiki/pentesting-cloud/aws-security/aws-privilege-escalation/aws-workdocs-privesc/index.html
  
  sensitive:
    - workdocs:CreateUser
    - workdocs:GetDocument
    - workdocs:AddResourcePermissions
    - workdocs:AddUserToGroup

acm-pca:
  urls:
    - https://cloud.hacktricks.wiki/pentesting-cloud/aws-security/aws-privilege-escalation/route53-createhostedzone-route53-changeresourcerecordsets-acm-pca-issuecertificate-acm-pca-getcer/index.html
  
  sensitive:
    - acm-pca:IssueCertificate
    - acm-pca:GetCertificate
    - acm-pca:ListCertificateAuthorities

apprunner:
  urls:
    - https://cloud.hacktricks.wiki/pentesting-cloud/aws-security/aws-privilege-escalation/aws-apprunner-privesc/index.html
  
  privesc:
    - iam:PassRole, apprunner:CreateService

autoscaling:
  urls:
    - https://cloud.hacktricks.wiki/pentesting-cloud/aws-security/aws-privilege-escalation/aws-ec2-privesc/index.html
  
  privesc:
    - autoscaling:CreateLaunchConfiguration, autoscaling:CreateAutoScalingGroup, iam:PassRole
    - autoscaling:UpdateAutoScalingGroup
  
  sensitive:
    - autoscaling:SuspendProcesses
    - autoscaling:DescribeAutoScalingGroups

cloud9:
  urls:
    - https://cloud.hacktricks.wiki/pentesting-cloud/aws-security/aws-privilege-escalation/aws-emr-privesc/index.html
  
  sensitive:
    - cloud9:DescribeEnvironment
    - cloud9:ValidateEnvironmentName

cloudfront:
  urls:
    - https://cloud.hacktricks.wiki/pentesting-cloud/aws-security/aws-privilege-escalation/aws-cloudfront-privesc/index.html
    - https://cloud.hacktricks.wiki/pentesting-cloud/aws-security/aws-post-exploitation/aws-cloudfront-post-exploitation/index.html
  
  privesc:
    - cloudfront:CreateFunction, cloudfront:PublishFunction, cloudfront:AssociateFunction, cloudfront:GetFunction
    - cloudfront:UpdateFunction, cloudfront:PublishFunction, cloudfront:UpdateDistribution
  
  sensitive:
    - cloudfront:GetDistributionConfig
    - cloudfront:UpdateDistribution
    - cloudfront:CreateFunction
    - cloudfront:UpdateFunction
    - cloudfront:Delete

cloudwatch:
  urls:
    - https://cloud.hacktricks.wiki/pentesting-cloud/aws-security/aws-privilege-escalation/index.html
  
  sensitive:
    - cloudwatch:DescribeAlarms
    - cloudwatch:GetMetricStatistics
    - cloudwatch:ListMetrics

codecommit:
  urls:
    - https://cloud.hacktricks.wiki/pentesting-cloud/aws-security/aws-privilege-escalation/aws-codebuild-privesc/index.html
  
  sensitive:
    - codecommit:ListRepositories

codestar-connections:
  urls:
    - https://cloud.hacktricks.wiki/pentesting-cloud/aws-security/aws-privilege-escalation/aws-codepipeline-privesc/index.html
  
  sensitive:
    - codestar-connections:UseConnection

cognito-identity:
  urls:
    - https://cloud.hacktricks.wiki/pentesting-cloud/aws-security/aws-privilege-escalation/aws-cognito-privesc/index.html
  
  privesc:
    - cognito-identity:SetIdentityPoolRoles, iam:PassRole
    - cognito-identity:UpdateIdentityPool

cognito-idp:
  urls:
    - https://cloud.hacktricks.wiki/pentesting-cloud/aws-security/aws-privilege-escalation/aws-cognito-privesc/index.html
  
  privesc:
    - cognito-idp:AdminAddUserToGroup
    - iam:PassRole, cognito-idp:CreateGroup
    - iam:PassRole, cognito-idp:UpdateGroup
    - cognito-idp:AdminConfirmSignUp
    - cognito-idp:AdminCreateUser
    - cognito-idp:AdminEnableUser
    - cognito-idp:AdminInitiateAuth, cognito-idp:AdminRespondToAuthChallenge
    - cognito-idp:AdminSetUserPassword
    - cognito-idp:CreateUserImportJob
    - cognito-idp:StartUserImportJob
    - cognito-idp:CreateIdentityProvider
    - cognito-idp:UpdateIdentityProvider
  
  sensitive:
    - cognito-idp:AdminSetUserSettings
    - cognito-idp:SetUserMFAPreference
    - cognito-idp:SetUserPoolMfaConfig
    - cognito-idp:UpdateUserPool
    - cognito-idp:AdminUpdateUserAttributes
    - cognito-idp:CreateUserPoolClient
    - cognito-idp:UpdateUserPoolClient
    - cognito-idp:SetRiskConfiguration

datazone:
  urls:
    - https://cloud.hacktricks.wiki/pentesting-cloud/aws-security/aws-privilege-escalation/aws-emr-privesc/index.html
  
  sensitive:
    - datazone:CreateUserProfile

dlm:
  urls:
    - https://cloud.hacktricks.wiki/pentesting-cloud/aws-security/aws-post-exploitation/aws-dlm-post-exploitation/index.html
  
  sensitive:
    - dlm:CreateLifeCyclePolicy

ec2-instance-connect:
  urls:
    - https://cloud.hacktricks.wiki/pentesting-cloud/aws-security/aws-privilege-escalation/aws-ec2-privesc/index.html
    - https://cloud.hacktricks.wiki/pentesting-cloud/aws-security/aws-post-exploitation/aws-ec2-ebs-ssm-and-vpc-post-exploitation/index.html
  
  privesc:
    - ec2-instance-connect:SendSSHPublicKey
    - ec2-instance-connect:SendSerialConsoleSSHPublicKey
  
  sensitive:
    - ec2-instance-connect:OpenTunnel

ecr-public:
  urls:
    - https://cloud.hacktricks.wiki/pentesting-cloud/aws-security/aws-post-exploitation/aws-ecr-post-exploitation/index.html
  
  sensitive:
    - ecr-public:BatchDeleteImage
    - ecr-public:DeleteRepository
    - ecr-public:SetRepositoryPolicy
    - ecr-public:GetAuthorizationToken
    - ecr-public:BatchGetImage

eks:
  urls:
    - https://cloud.hacktricks.wiki/pentesting-cloud/aws-security/aws-post-exploitation/aws-eks-post-exploitation/index.html
  
  sensitive:
    - eks:AccessKubernetesApi

elasticfilesystem:
  urls:
    - https://cloud.hacktricks.wiki/pentesting-cloud/aws-security/aws-privilege-escalation/aws-efs-privesc/index.html
    - https://cloud.hacktricks.wiki/pentesting-cloud/aws-security/aws-post-exploitation/aws-efs-post-exploitation/index.html
  
  sensitive:
    - elasticfilesystem:ClientMount
    - elasticfilesystem:ClientRootAccess
    - elasticfilesystem:ClientWrite
    - elasticfilesystem:CreateAccessPoint
    - elasticfilesystem:DeleteAccessPoint
    - elasticfilesystem:CreateMountTarget
    - elasticfilesystem:ModifyMountTargetSecurityGroups
    - elasticfilesystem:DeleteMountTarget
    - elasticfilesystem:DeleteFileSystem
    - elasticfilesystem:UpdateFileSystem
    - elasticfilesystem:PutFileSystemPolicy
    - elasticfilesystem:DeleteFileSystemPolicy

elasticmapreduce:
  urls:
    - https://cloud.hacktricks.wiki/pentesting-cloud/aws-security/aws-privilege-escalation/aws-emr-privesc/index.html
  
  privesc:
    - iam:PassRole, elasticmapreduce:RunJobFlow
    - elasticmapreduce:CreateEditor, elasticmapreduce:OpenEditorInConsole, iam:PassRole
    - elasticmapreduce:OpenEditorInConsole
  
  sensitive:
    - elasticmapreduce:ListClusters
    - elasticmapreduce:DescribeEditor

events:
  urls:
    - https://cloud.hacktricks.wiki/pentesting-cloud/aws-security/aws-persistence/aws-lambda-persistence/index.html
  
  sensitive:
    - events:PutRule
    - events:PutTargets
    - events:ListRuleNamesByTarget

firehose:
  urls:
    - https://cloud.hacktricks.wiki/pentesting-cloud/aws-security/aws-post-exploitation/aws-sns-post-exploitation/index.html
  
  sensitive:
    - firehose:PutRecord
    - firehose:PutRecordBatch

identitystore:
  urls:
    - https://cloud.hacktricks.wiki/pentesting-cloud/aws-security/aws-privilege-escalation/aws-sso-and-identitystore-privesc/index.html
  
  privesc:
    - identitystore:CreateGroupMembership

logs:
  urls:
    - https://cloud.hacktricks.wiki/pentesting-cloud/aws-security/aws-post-exploitation/aws-lambda-post-exploitation/index.html
  
  sensitive:
    - logs:CreateLogGroup
    - logs:PutLogEvents
    - logs:FilterLogEvents
    - logs:DescribeLogGroups

rds-data:
  urls:
    - https://cloud.hacktricks.wiki/pentesting-cloud/aws-security/aws-post-exploitation/aws-rds-post-exploitation/index.html
  
  sensitive:
    - rds-data:ExecuteStatement
    - rds-data:BatchExecuteStatement

redshift-data:
  urls:
    - https://cloud.hacktricks.wiki/pentesting-cloud/aws-security/aws-privilege-escalation/aws-redshift-privesc/index.html
  
  sensitive:
    - redshift-data:ExecuteStatement

scheduler:
  urls:
    - https://cloud.hacktricks.wiki/pentesting-cloud/aws-security/aws-privilege-escalation/eventbridgescheduler-privesc/index.html
  
  privesc:
    - scheduler:CreateSchedule, iam:PassRole
    - scheduler:UpdateSchedule

ses:
  urls:
    - https://cloud.hacktricks.wiki/pentesting-cloud/aws-security/aws-post-exploitation/aws-ses-post-exploitation/index.html
  
  sensitive:
    - ses:SendEmail
    - ses:SendRawEmail
    - ses:SendTemplatedEmail
    - ses:SendBulkEmail
    - ses:SendBulkTemplatedEmail

states:
  urls:
    - https://cloud.hacktricks.wiki/pentesting-cloud/aws-security/aws-privilege-escalation/aws-stepfunctions-privesc/index.html
    - https://cloud.hacktricks.wiki/pentesting-cloud/aws-security/aws-post-exploitation/aws-stepfunctions-post-exploitation/index.html
    - https://cloud.hacktricks.wiki/pentesting-cloud/aws-security/aws-persistence/aws-step-functions-persistence/index.html
  
  privesc:
    - iam:PassRole, states:CreateStateMachine
    - states:CreateStateMachine, states:StartExecution
  
  sensitive:
    - states:RevealSecrets
    - states:StartSyncExecution
    - states:StopExecution
    - states:DeleteStateMachine
    - states:UpdateStateMachine
    - states:TestState

vpn:
  urls:
    - https://cloud.hacktricks.wiki/pentesting-cloud/aws-security/aws-post-exploitation/aws-vpn-post-exploitation/index.html
  
  sensitive:
    - ec2:CreateVpnConnection
    - ec2:ModifyVpnConnection
    - ec2:DeleteVpnConnection

organizations:
  urls:
    - https://cloud.hacktricks.wiki/pentesting-cloud/aws-security/aws-privilege-escalation/aws-organizations-privesc/index.html
    - https://cloud.hacktricks.wiki/pentesting-cloud/aws-security/aws-post-exploitation/aws-organizations-post-exploitation/index.html
  
  sensitive:
    - organizations:CreateAccount
    - organizations:InviteAccountToOrganization
    - organizations:RemoveAccountFromOrganization
    - organizations:LeaveOrganization
    - organizations:AttachPolicy
    - organizations:DetachPolicy

macie:
  urls:
    - https://cloud.hacktricks.wiki/pentesting-cloud/aws-security/aws-privilege-escalation/aws-macie-privesc/index.html
  
  privesc:
    - macie2:CreateClassificationJob

mwaa:
  urls:
    - https://cloud.hacktricks.wiki/pentesting-cloud/aws-security/aws-post-exploitation/aws-mwaa-post-exploitation/index.html
  
  sensitive:
    - airflow:CreateWebLoginToken

controltower:
  urls:
    - https://cloud.hacktricks.wiki/pentesting-cloud/aws-security/aws-post-exploitation/aws-control-tower-post-exploitation/index.html
  
  sensitive:
    - controltower:CreateManagedAccount
    - controltower:DeregisterOrganizationalUnit

bedrock:
  urls:
    - https://cloud.hacktricks.wiki/pentesting-cloud/aws-security/aws-post-exploitation/aws-bedrock-post-exploitation/index.html
  
  sensitive:
    - bedrock:InvokeModel
    - bedrock:InvokeModelWithResponseStream