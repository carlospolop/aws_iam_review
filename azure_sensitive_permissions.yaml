app:
  urls:
    - https://cloud.hacktricks.wiki/pentesting-cloud/azure-security/az-privilege-escalation/az-container-instances-apps-jobs-privesc/index.html
    - https://cloud.hacktricks.wiki/pentesting-cloud/azure-security/az-privilege-escalation/az-functions-app-privesc/index.html

  privesc:
    - Microsoft.App/containerApps/getAuthToken/action
    - Microsoft.App/containerApps/listSecrets/action
    - Microsoft.App/containerApps/read, Microsoft.App/managedEnvironments/read, Microsoft.App/containerApps/revisions/read, Microsoft.App/containerApps/getAuthToken/action
    - Microsoft.App/containerApps/write
    - Microsoft.App/jobs/listSecrets/action
    - Microsoft.App/jobs/read, Microsoft.App/jobs/listSecrets/action
    - Microsoft.App/jobs/read, Microsoft.App/jobs/write
    - Microsoft.App/jobs/write
    - Microsoft.App/managedEnvironments/join/action

  sensitive:
    - Microsoft.App/containerApps/read
    - Microsoft.App/containerApps/revisions/read
    - Microsoft.App/jobs/read
    - Microsoft.App/managedEnvironments/read

authorization:
  urls:
    - https://cloud.hacktricks.wiki/pentesting-cloud/azure-security/az-privilege-escalation/az-authorization-privesc/index.html
    - https://cloud.hacktricks.wiki/pentesting-cloud/azure-security/az-privilege-escalation/az-virtual-desktop-privesc/index.html

  privesc:
    - Microsoft.Authorization/elevateAccess/action
    - Microsoft.Authorization/policyAssignments/delete
    - Microsoft.Authorization/policyAssignments/write
    - Microsoft.Authorization/policyDefinitions/write
    - Microsoft.Authorization/roleAssignments/read, Microsoft.Authorization/roleAssignments/write
    - Microsoft.Authorization/roleAssignments/write
    - Microsoft.Authorization/roleDefinitions/write

  sensitive:
    - Microsoft.Authorization/roleAssignments/read

automation:
  urls:
    - https://cloud.hacktricks.wiki/pentesting-cloud/azure-security/az-privilege-escalation/az-automation-accounts-privesc/index.html

  privesc:
    - Microsoft.Automation/automationAccounts/jobSchedules/write
    - Microsoft.Automation/automationAccounts/jobs/write
    - Microsoft.Automation/automationAccounts/runbooks/draft/write
    - Microsoft.Automation/automationAccounts/runbooks/publish/action
    - Microsoft.Automation/automationAccounts/runbooks/write
    - Microsoft.Automation/automationAccounts/schedules/write
    - Microsoft.Automation/automationAccounts/schedules/write, Microsoft.Automation/automationAccounts/jobSchedules/write
    - Microsoft.Automation/automationAccounts/sourceControls/write
    - Microsoft.Automation/automationAccounts/sourceControls/write, Microsoft.Automation/automationAccounts/sourceControls/read
    - Microsoft.Automation/automationAccounts/variables/write
    - Microsoft.Automation/automationAccounts/webhooks/write
    - Microsoft.Automation/automationAccounts/write

  sensitive:
    - Microsoft.Automation/automationAccounts/jobs/output/read
    - Microsoft.Automation/automationAccounts/sourceControls/read

cognitiveservices:
  urls:
    - https://cloud.hacktricks.wiki/pentesting-cloud/azure-security/az-privilege-escalation/az-ai-foundry-privesc/index.html

  privesc:
    - Microsoft.CognitiveServices/accounts/listKeys/action
    - Microsoft.CognitiveServices/accounts/regenerateKey/action

containerinstance:
  urls:
    - https://cloud.hacktricks.wiki/pentesting-cloud/azure-security/az-privilege-escalation/az-container-instances-apps-jobs-privesc/index.html

  privesc:
    - Microsoft.ContainerInstance/containerGroups/containers/exec/action
    - Microsoft.ContainerInstance/containerGroups/read, Microsoft.ContainerInstance/containerGroups/containers/exec/action
    - Microsoft.ContainerInstance/containerGroups/restart/action
    - Microsoft.ContainerInstance/containerGroups/write

  sensitive:
    - Microsoft.ContainerInstance/containerGroups/read

containerregistry:
  urls:
    - https://cloud.hacktricks.wiki/pentesting-cloud/azure-security/az-privilege-escalation/az-container-registry-privesc/index.html

  privesc:
    - Microsoft.ContainerRegistry/registries/generateCredentials/action
    - Microsoft.ContainerRegistry/registries/importImage/action
    - Microsoft.ContainerRegistry/registries/listBuildSourceUploadUrl/action
    - Microsoft.ContainerRegistry/registries/listBuildSourceUploadUrl/action, Microsoft.ContainerRegistry/registries/scheduleRun/action, Microsoft.ContainerRegistry/registries/runs/listLogSasUrl/action
    - Microsoft.ContainerRegistry/registries/listCredentials/action
    - Microsoft.ContainerRegistry/registries/runs/listLogSasUrl/action
    - Microsoft.ContainerRegistry/registries/scheduleRun/action
    - Microsoft.ContainerRegistry/registries/tasks/write
    - Microsoft.ContainerRegistry/registries/tokens/write
    - Microsoft.ContainerRegistry/registries/tokens/write, Microsoft.ContainerRegistry/registries/generateCredentials/action
    - Microsoft.ContainerRegistry/registries/write

  sensitive:
    - Microsoft.ContainerRegistry/registries/read
    - Microsoft.ContainerRegistry/registries/scopeMaps/read
    - Microsoft.ContainerRegistry/registries/tokens/operationStatuses/read
    - Microsoft.ContainerRegistry/registries/tokens/read

dbformysql:
  urls:
    - https://cloud.hacktricks.wiki/pentesting-cloud/azure-security/az-post-exploitation/az-mysql-post-exploitation/index.html
    - https://cloud.hacktricks.wiki/pentesting-cloud/azure-security/az-privilege-escalation/az-mysql-privesc/index.html

  privesc:
    - Microsoft.DBforMySQL/flexibleServers/administrators/write
    - Microsoft.DBforMySQL/flexibleServers/read, Microsoft.DBforMySQL/flexibleServers/write
    - Microsoft.DBforMySQL/flexibleServers/write

  sensitive:
    - Microsoft.DBforMySQL/flexibleServers/advancedThreatProtectionSettings/write
    - Microsoft.DBforMySQL/flexibleServers/administrators/read
    - Microsoft.DBforMySQL/flexibleServers/backups/read
    - Microsoft.DBforMySQL/flexibleServers/databases/read
    - Microsoft.DBforMySQL/flexibleServers/databases/write
    - Microsoft.DBforMySQL/flexibleServers/firewallRules/write
    - Microsoft.DBforMySQL/flexibleServers/read
    - Microsoft.DBforMySQL/flexibleServers/resetGtid/action
    - Microsoft.DBforMySQL/flexibleServers/start/action
    - Microsoft.DBforMySQL/flexibleServers/stop/action
    - Microsoft.DBforMySQL/flexibleServers/updateConfigurations/action
    - Microsoft.DBforMySQL/flexibleServers/write

dbforpostgresql:
  urls:
    - https://cloud.hacktricks.wiki/pentesting-cloud/azure-security/az-post-exploitation/az-postgresql-post-exploitation/index.html
    - https://cloud.hacktricks.wiki/pentesting-cloud/azure-security/az-privilege-escalation/az-postgresql-privesc/index.html

  privesc:
    - Microsoft.DBforPostgreSQL/flexibleServers/administrators/write
    - Microsoft.DBforPostgreSQL/flexibleServers/read, Microsoft.DBforPostgreSQL/flexibleServers/write
    - Microsoft.DBforPostgreSQL/flexibleServers/write

  sensitive:
    - Microsoft.DBforPostgreSQL/flexibleServers/advancedThreatProtectionSettings/read
    - Microsoft.DBforPostgreSQL/flexibleServers/advancedThreatProtectionSettings/write
    - Microsoft.DBforPostgreSQL/flexibleServers/administrators/read
    - Microsoft.DBforPostgreSQL/flexibleServers/backups/read
    - Microsoft.DBforPostgreSQL/flexibleServers/configurations/read
    - Microsoft.DBforPostgreSQL/flexibleServers/configurations/write
    - Microsoft.DBforPostgreSQL/flexibleServers/databases/read
    - Microsoft.DBforPostgreSQL/flexibleServers/databases/write
    - Microsoft.DBforPostgreSQL/flexibleServers/firewallRules/read
    - Microsoft.DBforPostgreSQL/flexibleServers/firewallRules/write
    - Microsoft.DBforPostgreSQL/flexibleServers/read
    - Microsoft.DBforPostgreSQL/flexibleServers/start/action
    - Microsoft.DBforPostgreSQL/flexibleServers/stop/action
    - Microsoft.DBforPostgreSQL/flexibleServers/write

desktopvirtualization:
  urls:
    - https://cloud.hacktricks.wiki/pentesting-cloud/azure-security/az-privilege-escalation/az-virtual-desktop-privesc/index.html

  privesc:
    - Microsoft.DesktopVirtualization/hostPools/retrieveRegistrationToken/action

documentdb:
  urls:
    - https://cloud.hacktricks.wiki/pentesting-cloud/azure-security/az-post-exploitation/az-cosmosDB-post-exploitation/index.html
    - https://cloud.hacktricks.wiki/pentesting-cloud/azure-security/az-privilege-escalation/az-cosmosDB-privesc/index.html

  privesc:
    - Microsoft.DocumentDB/databaseAccounts/listKeys/action
    - Microsoft.DocumentDB/databaseAccounts/mongodbRoleDefinitions/write
    - Microsoft.DocumentDB/databaseAccounts/mongodbRoleDefinitions/write, Microsoft.DocumentDB/databaseAccounts/mongodbRoleDefinitions/read, Microsoft.DocumentDB/databaseAccounts/mongodbUserDefinitions/write, Microsoft.DocumentDB/databaseAccounts/mongodbUserDefinitions/read
    - Microsoft.DocumentDB/databaseAccounts/mongodbUserDefinitions/write
    - Microsoft.DocumentDB/databaseAccounts/sqlRoleAssignments/write
    - Microsoft.DocumentDB/databaseAccounts/sqlRoleDefinitions/write
    - Microsoft.DocumentDB/databaseAccounts/sqlRoleDefinitions/write, Microsoft.DocumentDB/databaseAccounts/sqlRoleDefinitions/read, Microsoft.DocumentDB/databaseAccounts/sqlRoleAssignments/write, Microsoft.DocumentDB/databaseAccounts/sqlRoleAssignments/read
    - Microsoft.DocumentDB/mongoClusters/firewallRules/write
    - Microsoft.DocumentDB/mongoClusters/read, Microsoft.DocumentDB/mongoClusters/firewallRules/write
    - Microsoft.DocumentDB/mongoClusters/read, Microsoft.DocumentDB/mongoClusters/write
    - Microsoft.DocumentDB/mongoClusters/write

  sensitive:
    - Microsoft.DocumentDB/databaseAccounts/failoverPriorityChange/action
    - Microsoft.DocumentDB/databaseAccounts/mongodbRoleDefinitions/read
    - Microsoft.DocumentDB/databaseAccounts/mongodbUserDefinitions/read
    - Microsoft.DocumentDB/databaseAccounts/mongodbDatabases/collections/read
    - Microsoft.DocumentDB/databaseAccounts/mongodbDatabases/collections/write
    - Microsoft.DocumentDB/databaseAccounts/mongodbDatabases/read
    - Microsoft.DocumentDB/databaseAccounts/mongodbDatabases/write
    - Microsoft.DocumentDB/databaseAccounts/read
    - Microsoft.DocumentDB/databaseAccounts/regenerateKey/action
    - Microsoft.DocumentDB/databaseAccounts/sqlDatabases/containers/items/read
    - Microsoft.DocumentDB/databaseAccounts/sqlRoleAssignments/read
    - Microsoft.DocumentDB/databaseAccounts/sqlRoleDefinitions/read
    - Microsoft.DocumentDB/databaseAccounts/sqlDatabases/containers/read
    - Microsoft.DocumentDB/databaseAccounts/sqlDatabases/containers/storedProcedures/read
    - Microsoft.DocumentDB/databaseAccounts/sqlDatabases/containers/storedProcedures/write
    - Microsoft.DocumentDB/databaseAccounts/sqlDatabases/containers/triggers/read
    - Microsoft.DocumentDB/databaseAccounts/sqlDatabases/containers/triggers/write
    - Microsoft.DocumentDB/databaseAccounts/sqlDatabases/containers/userDefinedFunctions/read
    - Microsoft.DocumentDB/databaseAccounts/sqlDatabases/containers/userDefinedFunctions/write
    - Microsoft.DocumentDB/databaseAccounts/sqlDatabases/containers/write
    - Microsoft.DocumentDB/databaseAccounts/sqlDatabases/read
    - Microsoft.DocumentDB/databaseAccounts/sqlDatabases/write
    - Microsoft.DocumentDB/databaseAccounts/write

entra:
  urls:
    - https://cloud.hacktricks.wiki/pentesting-cloud/azure-security/az-privilege-escalation/az-entraid-privesc/az-conditional-access-policies-mfa-bypass/index.html
    - https://cloud.hacktricks.wiki/pentesting-cloud/azure-security/az-privilege-escalation/az-entraid-privesc/dynamic-groups/index.html

  privesc:
    - Group.Read.All
    - Policy.Read.All
    - Policy.Read.ConditionalAccess
    - Sites.Read.All

keyvault:
  urls:
    - https://cloud.hacktricks.wiki/pentesting-cloud/azure-security/az-post-exploitation/az-key-vault-post-exploitation/index.html
    - https://cloud.hacktricks.wiki/pentesting-cloud/azure-security/az-privilege-escalation/az-key-vault-privesc/index.html

  privesc:
    - Microsoft.KeyVault/vaults/write

  sensitive:
    - Microsoft.KeyVault/vaults/certificates/delete
    - Microsoft.KeyVault/vaults/certificates/purge/action
    - Microsoft.KeyVault/vaults/keys/decrypt/action
    - Microsoft.KeyVault/vaults/keys/delete
    - Microsoft.KeyVault/vaults/keys/encrypt/action
    - Microsoft.KeyVault/vaults/keys/purge/action
    - Microsoft.KeyVault/vaults/keys/recover/action
    - Microsoft.KeyVault/vaults/secrets/delete
    - Microsoft.KeyVault/vaults/secrets/getSecret/action
    - Microsoft.KeyVault/vaults/secrets/purge/action
    - Microsoft.KeyVault/vaults/secrets/restore/action
    - Microsoft.KeyVault/vaults/secrets/setSecret/action

logic:
  urls:
    - https://cloud.hacktricks.wiki/pentesting-cloud/azure-security/az-post-exploitation/az-logic-apps-post-exploitation/index.html
    - https://cloud.hacktricks.wiki/pentesting-cloud/azure-security/az-privilege-escalation/az-logic-apps-privesc/index.html

  privesc:
    - Microsoft.Logic/workflows/triggers/listCallbackUrl/action
    - Microsoft.Logic/workflows/triggers/run/action
    - Microsoft.Logic/workflows/write

  sensitive:
    - Microsoft.Logic/integrationAccounts/batchConfigurations/write
    - Microsoft.Logic/integrationAccounts/maps/write
    - Microsoft.Logic/integrationAccounts/partners/write
    - Microsoft.Logic/integrationAccounts/sessions/write
    - Microsoft.Logic/integrationAccounts/write
    - Microsoft.Logic/workflows/read
    - Microsoft.Logic/workflows/regenerateAccessKey/action
    - Microsoft.Logic/workflows/write

machinelearningservices:
  urls:
    - https://cloud.hacktricks.wiki/pentesting-cloud/azure-security/az-privilege-escalation/az-ai-foundry-privesc/index.html

  privesc:
    - Microsoft.MachineLearningServices/workspaces/computes/write
    - Microsoft.MachineLearningServices/workspaces/connections/listsecrets/action
    - Microsoft.MachineLearningServices/workspaces/connections/listsecrets/action, Microsoft.MachineLearningServices/workspaces/datastores/listSecrets/action
    - Microsoft.MachineLearningServices/workspaces/data/delete
    - Microsoft.MachineLearningServices/workspaces/data/versions/write
    - Microsoft.MachineLearningServices/workspaces/data/write
    - Microsoft.MachineLearningServices/workspaces/datasets/registered/write
    - Microsoft.MachineLearningServices/workspaces/datastores/listSecrets/action
    - Microsoft.MachineLearningServices/workspaces/experiments/runs/submit/action
    - Microsoft.MachineLearningServices/workspaces/hubs/write
    - Microsoft.MachineLearningServices/workspaces/jobs/write
    - Microsoft.MachineLearningServices/workspaces/jobs/write, Microsoft.MachineLearningServices/workspaces/experiments/runs/submit/action
    - Microsoft.MachineLearningServices/workspaces/onlineEndpoints/deployments/write
    - Microsoft.MachineLearningServices/workspaces/onlineEndpoints/score/action
    - Microsoft.MachineLearningServices/workspaces/onlineEndpoints/write
    - Microsoft.MachineLearningServices/workspaces/onlineEndpoints/write, Microsoft.MachineLearningServices/workspaces/onlineEndpoints/deployments/write, Microsoft.MachineLearningServices/workspaces/read
    - Microsoft.MachineLearningServices/workspaces/write

  sensitive:
    - Microsoft.MachineLearningServices/workspaces/onlineEndpoints/read
    - Microsoft.MachineLearningServices/workspaces/read

managedidentity:
  urls:
    - https://cloud.hacktricks.wiki/pentesting-cloud/azure-security/az-post-exploitation/az-logic-apps-post-exploitation/index.html
    - https://cloud.hacktricks.wiki/pentesting-cloud/azure-security/az-post-exploitation/az-mysql-post-exploitation/index.html
    - https://cloud.hacktricks.wiki/pentesting-cloud/azure-security/az-post-exploitation/az-postgresql-post-exploitation/index.html
    - https://cloud.hacktricks.wiki/pentesting-cloud/azure-security/az-privilege-escalation/az-ai-foundry-privesc/index.html
    - https://cloud.hacktricks.wiki/pentesting-cloud/azure-security/az-privilege-escalation/az-app-services-privesc/index.html
    - https://cloud.hacktricks.wiki/pentesting-cloud/azure-security/az-privilege-escalation/az-authorization-privesc/index.html
    - https://cloud.hacktricks.wiki/pentesting-cloud/azure-security/az-privilege-escalation/az-automation-accounts-privesc/index.html
    - https://cloud.hacktricks.wiki/pentesting-cloud/azure-security/az-privilege-escalation/az-container-instances-apps-jobs-privesc/index.html
    - https://cloud.hacktricks.wiki/pentesting-cloud/azure-security/az-privilege-escalation/az-container-registry-privesc/index.html
    - https://cloud.hacktricks.wiki/pentesting-cloud/azure-security/az-privilege-escalation/az-functions-app-privesc/index.html
    - https://cloud.hacktricks.wiki/pentesting-cloud/azure-security/az-privilege-escalation/az-logic-apps-privesc/index.html
    - https://cloud.hacktricks.wiki/pentesting-cloud/azure-security/az-privilege-escalation/az-mysql-privesc/index.html
    - https://cloud.hacktricks.wiki/pentesting-cloud/azure-security/az-privilege-escalation/az-postgresql-privesc/index.html
    - https://cloud.hacktricks.wiki/pentesting-cloud/azure-security/az-privilege-escalation/az-virtual-machines-and-network-privesc/index.html

  privesc:
    - Microsoft.ManagedIdentity/userAssignedIdentities/assign/action
    - Microsoft.ManagedIdentity/userAssignedIdentities/federatedIdentityCredentials/write

  sensitive:
    - Microsoft.ManagedIdentity/userAssignedIdentities/assign/action

management:
  urls:
    - https://cloud.hacktricks.wiki/pentesting-cloud/azure-security/az-privilege-escalation/az-authorization-privesc/index.html

  privesc:
    - Microsoft.Management/managementGroups/subscriptions/write
    - Microsoft.Management/managementGroups/write

miscperms:
  urls:
    - https://cloud.hacktricks.wiki/pentesting-cloud/azure-security/az-privilege-escalation/az-ai-foundry-privesc/index.html
    - https://cloud.hacktricks.wiki/pentesting-cloud/azure-security/az-privilege-escalation/az-app-services-privesc/index.html
    - https://cloud.hacktricks.wiki/pentesting-cloud/azure-security/az-privilege-escalation/az-automation-accounts-privesc/index.html
    - https://cloud.hacktricks.wiki/pentesting-cloud/azure-security/az-privilege-escalation/az-container-instances-apps-jobs-privesc/index.html
    - https://cloud.hacktricks.wiki/pentesting-cloud/azure-security/az-privilege-escalation/az-functions-app-privesc/index.html
    - https://cloud.hacktricks.wiki/pentesting-cloud/azure-security/az-privilege-escalation/az-logic-apps-privesc/index.html
    - https://cloud.hacktricks.wiki/pentesting-cloud/azure-security/az-privilege-escalation/az-mysql-privesc/index.html
    - https://cloud.hacktricks.wiki/pentesting-cloud/azure-security/az-privilege-escalation/az-postgresql-privesc/index.html
    - https://cloud.hacktricks.wiki/pentesting-cloud/azure-security/az-privilege-escalation/az-virtual-machines-and-network-privesc/index.html

  privesc:
    - Microsoft.App/containerApps/write, Microsoft.ManagedIdentity/userAssignedIdentities/assign/action
    - Microsoft.App/containerApps/write, Microsoft.ManagedIdentity/userAssignedIdentities/assign/action, Microsoft.App/managedEnvironments/join/action
    - Microsoft.App/managedEnvironments/read, Microsoft.App/jobs/write, Microsoft.App/managedEnvironments/join/action, Microsoft.ManagedIdentity/userAssignedIdentities/assign/action
    - Microsoft.Automation/automationAccounts/jobs/write, Microsoft.Automation/automationAccounts/runbooks/draft/write, Microsoft.Automation/automationAccounts/jobs/output/read, Microsoft.Automation/automationAccounts/runbooks/publish/action, Microsoft.Resources/subscriptions/resourcegroups/read, Microsoft.Automation/automationAccounts/runbooks/write
    - Microsoft.Automation/automationAccounts/write, Microsoft.ManagedIdentity/userAssignedIdentities/assign/action
    - Microsoft.ContainerInstance/containerGroups/write, Microsoft.ManagedIdentity/userAssignedIdentities/assign/action
    - Microsoft.DBforMySQL/flexibleServers/read, Microsoft.DBforMySQL/flexibleServers/write, Microsoft.DBforMySQL/flexibleServers/backups/read, Microsoft.ManagedIdentity/userAssignedIdentities/assign/action
    - Microsoft.DBforMySQL/flexibleServers/read, Microsoft.DBforMySQL/flexibleServers/write, Microsoft.ManagedIdentity/userAssignedIdentities/assign/action, Microsoft.DBforMySQL/flexibleServers/administrators/write, Microsoft.DBforMySQL/flexibleServers/administrators/read
    - Microsoft.DBforPostgreSQL/flexibleServers/read, Microsoft.DBforPostgreSQL/flexibleServers/write, Microsoft.DBforPostgreSQL/flexibleServers/backups/read, Microsoft.ManagedIdentity/userAssignedIdentities/assign/action
    - Microsoft.DBforPostgreSQL/flexibleServers/read, Microsoft.DBforPostgreSQL/flexibleServers/write, Microsoft.ManagedIdentity/userAssignedIdentities/assign/action, Microsoft.DBforPostgreSQL/flexibleServers/administrators/write, Microsoft.DBforPostgreSQL/flexibleServers/administrators/read
    - Microsoft.Logic/workflows/read, Microsoft.Logic/workflows/write, Microsoft.ManagedIdentity/userAssignedIdentities/assign/action
    - Microsoft.MachineLearningServices/workspaces/data/write, Microsoft.MachineLearningServices/workspaces/data/delete, Microsoft.Storage/storageAccounts/blobServices/containers/write, Microsoft.MachineLearningServices/workspaces/data/versions/write, Microsoft.MachineLearningServices/workspaces/datasets/registered/write
    - Microsoft.MachineLearningServices/workspaces/hubs/write, Microsoft.MachineLearningServices/workspaces/write, Microsoft.ManagedIdentity/userAssignedIdentities/assign/action
    - Microsoft.ManagedIdentity/userAssignedIdentities/assign/action, Microsoft.App/jobs/write
    - Microsoft.Resources/deployments/write, Microsoft.Network/virtualNetworks/write, Microsoft.Network/networkSecurityGroups/write, Microsoft.Network/networkSecurityGroups/join/action, Microsoft.Network/publicIPAddresses/write, Microsoft.Network/publicIPAddresses/join/action, Microsoft.Network/networkInterfaces/write, Microsoft.Network/virtualNetworks/subnets/join/action, Microsoft.Network/networkInterfaces/join/action, Microsoft.ManagedIdentity/userAssignedIdentities/assign/action
    - Microsoft.Resources/subscriptions/resourcegroups/read, Microsoft.ContainerInstance/containerGroups/write, Microsoft.ManagedIdentity/userAssignedIdentities/assign/action
    - Microsoft.Resources/subscriptions/resourcegroups/read, Microsoft.Logic/workflows/read, Microsoft.Logic/workflows/write, Microsoft.ManagedIdentity/userAssignedIdentities/assign/action, Microsoft.Logic/workflows/triggers/run/action
    - Microsoft.Web/sites/write, Microsoft.ManagedIdentity/userAssignedIdentities/assign/action, Microsoft.App/managedEnvironments/join/action, Microsoft.Web/sites/read, Microsoft.Web/sites/operationresults/read
    - Microsoft.Web/sites/write, Microsoft.Web/sites/read, Microsoft.ManagedIdentity/userAssignedIdentities/assign/action

network:
  urls:
    - https://cloud.hacktricks.wiki/pentesting-cloud/azure-security/az-privilege-escalation/az-virtual-machines-and-network-privesc/index.html

  privesc:
    - Microsoft.Network/networkInterfaces/join/action
    - Microsoft.Network/networkInterfaces/read, Microsoft.Network/networkInterfaces/join/action
    - Microsoft.Network/networkInterfaces/write
    - Microsoft.Network/networkSecurityGroups/join/action
    - Microsoft.Network/networkSecurityGroups/write
    - Microsoft.Network/publicIPAddresses/join/action
    - Microsoft.Network/publicIPAddresses/write
    - Microsoft.Network/virtualNetworks/subnets/join/action
    - Microsoft.Network/virtualNetworks/write

  sensitive:
    - Microsoft.Network/networkInterfaces/read

resources:
  urls:
    - https://cloud.hacktricks.wiki/pentesting-cloud/azure-security/az-post-exploitation/az-logic-apps-post-exploitation/index.html
    - https://cloud.hacktricks.wiki/pentesting-cloud/azure-security/az-privilege-escalation/az-automation-accounts-privesc/index.html
    - https://cloud.hacktricks.wiki/pentesting-cloud/azure-security/az-privilege-escalation/az-container-instances-apps-jobs-privesc/index.html
    - https://cloud.hacktricks.wiki/pentesting-cloud/azure-security/az-privilege-escalation/az-logic-apps-privesc/index.html
    - https://cloud.hacktricks.wiki/pentesting-cloud/azure-security/az-privilege-escalation/az-virtual-machines-and-network-privesc/index.html

  privesc:
    - Microsoft.Resources/deployments/write

  sensitive:
    - Microsoft.Resources/subscriptions/resourcegroups/read

search:
  urls:
    - https://cloud.hacktricks.wiki/pentesting-cloud/azure-security/az-privilege-escalation/az-ai-foundry-privesc/index.html

  privesc:
    - Microsoft.Search/searchServices/createQueryKey/action
    - Microsoft.Search/searchServices/listAdminKeys/action
    - Microsoft.Search/searchServices/listQueryKeys/action
    - Microsoft.Search/searchServices/regenerateAdminKey/action

servicebus:
  urls:
    - https://cloud.hacktricks.wiki/pentesting-cloud/azure-security/az-post-exploitation/az-servicebus-post-exploitation/index.html
    - https://cloud.hacktricks.wiki/pentesting-cloud/azure-security/az-privilege-escalation/az-servicebus-privesc/index.html

  privesc:
    - Microsoft.ServiceBus/namespaces/AuthorizationRules/write
    - Microsoft.ServiceBus/namespaces/authorizationrules/listKeys/action
    - Microsoft.ServiceBus/namespaces/authorizationrules/regenerateKeys/action
    - Microsoft.ServiceBus/namespaces/messages/receive/action
    - Microsoft.ServiceBus/namespaces/messages/send/action
    - Microsoft.ServiceBus/namespaces/write
    - Microsoft.ServiceBus/namespaces/write, Microsoft.ServiceBus/namespaces/read

  sensitive:
    - Microsoft.ServiceBus/namespaces/delete
    - Microsoft.ServiceBus/namespaces/read
    - Microsoft.ServiceBus/namespaces/authorizationRules/read
    - Microsoft.ServiceBus/namespaces/queues/delete
    - Microsoft.ServiceBus/namespaces/queues/read
    - Microsoft.ServiceBus/namespaces/queues/write
    - Microsoft.ServiceBus/namespaces/topics/delete
    - Microsoft.ServiceBus/namespaces/topics/read
    - Microsoft.ServiceBus/namespaces/topics/subscriptions/delete
    - Microsoft.ServiceBus/namespaces/topics/subscriptions/read
    - Microsoft.ServiceBus/namespaces/topics/subscriptions/write
    - Microsoft.ServiceBus/namespaces/topics/write

sql:
  urls:
    - https://cloud.hacktricks.wiki/pentesting-cloud/azure-security/az-post-exploitation/az-sql-post-exploitation/index.html
    - https://cloud.hacktricks.wiki/pentesting-cloud/azure-security/az-privilege-escalation/az-sql-privesc/index.html

  privesc:
    - Microsoft.Sql/servers/administrators/write
    - Microsoft.Sql/servers/administrators/write, Microsoft.Sql/servers/administrators/read
    - Microsoft.Sql/servers/azureADOnlyAuthentications/write
    - Microsoft.Sql/servers/azureADOnlyAuthentications/write, Microsoft.Sql/servers/azureADOnlyAuthentications/read
    - Microsoft.Sql/servers/databases/dataMaskingPolicies/write
    - Microsoft.Sql/servers/firewallRules/write
    - Microsoft.Sql/servers/ipv6FirewallRules/delete
    - Microsoft.Sql/servers/ipv6FirewallRules/write
    - Microsoft.Sql/servers/outboundFirewallRules/delete
    - Microsoft.Sql/servers/read, Microsoft.Sql/servers/write
    - Microsoft.Sql/servers/write

  sensitive:
    - Microsoft.Sql/locations/connectionPoliciesAzureAsyncOperation/read
    - Microsoft.Sql/locations/ledgerDigestUploadsAzureAsyncOperation/read
    - Microsoft.Sql/locations/ledgerDigestUploadsOperationResults/read
    - Microsoft.Sql/locations/transparentDataEncryptionAzureAsyncOperation/read
    - Microsoft.Sql/servers/auditingSettings/read
    - Microsoft.Sql/servers/auditingSettings/write
    - Microsoft.Sql/servers/administrators/read
    - Microsoft.Sql/servers/azureADOnlyAuthentications/read
    - Microsoft.Sql/servers/connectionPolicies/read
    - Microsoft.Sql/servers/connectionPolicies/write
    - Microsoft.Sql/servers/databases/export/action
    - Microsoft.Sql/servers/databases/import/action
    - Microsoft.Sql/servers/databases/ledgerDigestUploads/disable/action
    - Microsoft.Sql/servers/databases/read
    - Microsoft.Sql/servers/databases/transparentDataEncryption/read
    - Microsoft.Sql/servers/databases/transparentDataEncryption/write
    - Microsoft.Sql/servers/databases/write
    - Microsoft.Sql/servers/elasticPools/read
    - Microsoft.Sql/servers/elasticPools/write
    - Microsoft.Sql/servers/keys/read
    - Microsoft.Sql/servers/keys/write
    - Microsoft.Sql/servers/read

storage:
  urls:
    - https://cloud.hacktricks.wiki/pentesting-cloud/azure-security/az-persistence/az-queue-persistence/index.html
    - https://cloud.hacktricks.wiki/pentesting-cloud/azure-security/az-persistence/az-storage-persistence/index.html
    - https://cloud.hacktricks.wiki/pentesting-cloud/azure-security/az-post-exploitation/az-blob-storage-post-exploitation/index.html
    - https://cloud.hacktricks.wiki/pentesting-cloud/azure-security/az-post-exploitation/az-file-share-post-exploitation/index.html
    - https://cloud.hacktricks.wiki/pentesting-cloud/azure-security/az-post-exploitation/az-queue-post-exploitation/index.html
    - https://cloud.hacktricks.wiki/pentesting-cloud/azure-security/az-post-exploitation/az-table-storage-post-exploitation/index.html
    - https://cloud.hacktricks.wiki/pentesting-cloud/azure-security/az-privilege-escalation/az-ai-foundry-privesc/index.html
    - https://cloud.hacktricks.wiki/pentesting-cloud/azure-security/az-privilege-escalation/az-queue-privesc/index.html
    - https://cloud.hacktricks.wiki/pentesting-cloud/azure-security/az-privilege-escalation/az-storage-privesc/index.html

  privesc:
    - Microsoft.Storage/storageAccounts/blobServices/containers/blobs/immutableStorage/runAsSuperUser/action
    - Microsoft.Storage/storageAccounts/blobServices/containers/blobs/manageOwnership/action
    - Microsoft.Storage/storageAccounts/blobServices/containers/blobs/modifyPermissions/action
    - Microsoft.Storage/storageAccounts/blobServices/containers/blobs/runAsSuperUser/action
    - Microsoft.Storage/storageAccounts/blobServices/containers/immutabilityPolicies/delete
    - Microsoft.Storage/storageAccounts/blobServices/containers/immutabilityPolicies/write
    - Microsoft.Storage/storageAccounts/blobServices/containers/write
    - Microsoft.Storage/storageAccounts/fileServices/fileshares/files/actassuperuser/action
    - Microsoft.Storage/storageAccounts/fileServices/fileshares/files/modifypermissions/action
    - Microsoft.Storage/storageAccounts/fileServices/shares/restore/action
    - Microsoft.Storage/storageAccounts/fileServices/shares/restore/action, Microsoft.Storage/storageAccounts/read
    - Microsoft.Storage/storageAccounts/fileServices/takeOwnership/action
    - Microsoft.Storage/storageAccounts/listKeys/action
    - Microsoft.Storage/storageAccounts/localusers/regeneratePassword/action
    - Microsoft.Storage/storageAccounts/localusers/write
    - Microsoft.Storage/storageAccounts/localusers/write, Microsoft.Storage/storageAccounts/localusers/read
    - Microsoft.Storage/storageAccounts/queueServices/queues/messages/add/action
    - Microsoft.Storage/storageAccounts/queueServices/queues/messages/process/action
    - Microsoft.Storage/storageAccounts/queueServices/queues/messages/write
    - Microsoft.Storage/storageAccounts/queueServices/queues/write
    - Microsoft.Storage/storageAccounts/regenerateKey/action
    - Microsoft.Storage/storageAccounts/restoreBlobRanges/action
    - Microsoft.Storage/storageAccounts/restoreBlobRanges/action, Microsoft.Storage/storageAccounts/blobServices/containers/read, Microsoft.Storage/storageAccounts/read, Microsoft.Storage/storageAccounts/listKeys/action
    - Microsoft.Storage/storageAccounts/write

  sensitive:
    - Microsoft.Storage/storageAccounts/blobServices/containers/blobs/read
    - Microsoft.Storage/storageAccounts/blobServices/containers/blobs/write
    - Microsoft.Storage/storageAccounts/blobServices/deletePolicy/write
    - Microsoft.Storage/storageAccounts/blobServices/containers/read
    - Microsoft.Storage/storageAccounts/fileServices/fileshares/files/read
    - Microsoft.Storage/storageAccounts/fileServices/fileshares/files/write
    - Microsoft.Storage/storageAccounts/fileServices/writeFileBackupSemantics/action
    - Microsoft.Storage/storageAccounts/listKeys/action
    - Microsoft.Storage/storageAccounts/localusers/read
    - Microsoft.Storage/storageAccounts/queueServices/queues/delete
    - Microsoft.Storage/storageAccounts/queueServices/queues/messages/add/action
    - Microsoft.Storage/storageAccounts/queueServices/queues/messages/delete
    - Microsoft.Storage/storageAccounts/queueServices/queues/messages/process/action
    - Microsoft.Storage/storageAccounts/queueServices/queues/messages/read
    - Microsoft.Storage/storageAccounts/queueServices/queues/messages/write
    - Microsoft.Storage/storageAccounts/queueServices/queues/write
    - Microsoft.Storage/storageAccounts/read
    - Microsoft.Storage/storageAccounts/tableServices/tables/entities/add/action
    - Microsoft.Storage/storageAccounts/tableServices/tables/entities/read
    - Microsoft.Storage/storageAccounts/tableServices/tables/entities/update/action
    - Microsoft.Storage/storageAccounts/tableServices/tables/entities/write

web:
  urls:
    - https://cloud.hacktricks.wiki/pentesting-cloud/azure-security/az-post-exploitation/az-logic-apps-post-exploitation/index.html
    - https://cloud.hacktricks.wiki/pentesting-cloud/azure-security/az-privilege-escalation/az-app-services-privesc/index.html
    - https://cloud.hacktricks.wiki/pentesting-cloud/azure-security/az-privilege-escalation/az-functions-app-privesc/index.html
    - https://cloud.hacktricks.wiki/pentesting-cloud/azure-security/az-privilege-escalation/az-logic-apps-privesc/index.html
    - https://cloud.hacktricks.wiki/pentesting-cloud/azure-security/az-privilege-escalation/az-static-web-apps-privesc/index.html

  privesc:
    - Microsoft.Web/sites/basicPublishingCredentialsPolicies/write
    - Microsoft.Web/sites/config/list/action
    - Microsoft.Web/sites/config/list/action, Microsoft.Web/sites/config/write
    - Microsoft.Web/sites/config/write
    - Microsoft.Web/sites/config/write, Microsoft.Web/sites/config/list/action, Microsoft.Web/sites/read, Microsoft.Web/sites/config/read
    - Microsoft.Web/sites/config/write, Microsoft.Web/sites/config/read, Microsoft.Web/sites/config/list/action, Microsoft.Web/sites/read
    - Microsoft.Web/sites/functions/listKeys/action
    - Microsoft.Web/sites/functions/token/action
    - Microsoft.Web/sites/host/functionKeys/write
    - Microsoft.Web/sites/host/listkeys/action
    - Microsoft.Web/sites/host/masterKey/write
    - Microsoft.Web/sites/host/systemKeys/write
    - Microsoft.Web/sites/hostruntime/vfs/write
    - Microsoft.Web/sites/publish/action
    - Microsoft.Web/sites/publish/action, Microsoft.Web/sites/basicPublishingCredentialsPolicies/read, Microsoft.Web/sites/config/read, Microsoft.Web/sites/read
    - Microsoft.Web/sites/publishxml/action
    - Microsoft.Web/sites/publishxml/action, Microsoft.Web/sites/basicPublishingCredentialsPolicies/write
    - Microsoft.Web/sites/read, Microsoft.Web/sites/basicPublishingCredentialsPolicies/read, Microsoft.Web/sites/write, Microsoft.Web/sites/config/list/action, Microsoft.Web/sites/start/action
    - Microsoft.Web/sites/start/action
    - Microsoft.Web/sites/write
    - Microsoft.Web/staticSites/config/write
    - Microsoft.Web/staticSites/createUserInvitation/action
    - Microsoft.Web/staticSites/listSecrets/action
    - Microsoft.Web/staticSites/resetapikey/action
    - Microsoft.Web/staticSites/snippets/write
    - Microsoft.Web/staticSites/write

  sensitive:
    - Microsoft.Web/sites/config/list/action
    - Microsoft.Web/sites/basicPublishingCredentialsPolicies/read
    - Microsoft.Web/sites/config/read
    - Microsoft.Web/sites/config/write
    - Microsoft.Web/sites/functions/properties/read
    - Microsoft.Web/sites/hostruntime/vfs/read
    - Microsoft.Web/sites/operationresults/read
    - Microsoft.Web/sites/read
    - Microsoft.Web/sites/sourcecontrols/read
    - Microsoft.Web/sites/restart/action
    - Microsoft.Web/sites/start/action
    - Microsoft.Web/sites/stop/action
    - Microsoft.Web/sites/write
